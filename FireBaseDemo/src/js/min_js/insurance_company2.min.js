import{initializeApp}from"https://www.gstatic.com/firebasejs/9.8.3/firebase-app.js";import{getAnalytics}from"https://www.gstatic.com/firebasejs/9.8.3/firebase-analytics.js";import{delCookie,getCookie}from"./common_function.js";const firebaseConfig={apiKey:"AIzaSyDtTxfCIJIfPTEw44Ah5I1lpjiDO96FlJM",authDomain:"mydatabase-8f225.firebaseapp.com",databaseURL:"https://mydatabase-8f225-default-rtdb.firebaseio.com",projectId:"mydatabase-8f225",storageBucket:"mydatabase-8f225.appspot.com",messagingSenderId:"68532714578",appId:"1:68532714578:web:fc038b336827906b65338b",measurementId:"G-68RXLWEXS7"};firebase.initializeApp(firebaseConfig);var db=firebase.database();const FubonInsurance=[],CathayCenturyInsurance=[],NanShanInsurance=[],ShinkongInsurance=[],NAN=[];var users_id,user_id,data,count=1,customer_count=1;null==getCookie("CompanyName")&&(alert("請先登入再前往本頁面!"),window.location="insuranceCompany_login.html");var logout_btn=document.querySelector(".logout_btn");logout_btn.addEventListener("click",(e=>{delCookie("CompanyName"),document.cookie="LoginStatus=No",window.location="insuranceCompany_login.html"})),db.ref("/InsuranceCompany/"+getCookie("CompanyName")).once("value",(function(e){data=e.val(),document.querySelector(".companyName").innerHTML=data.CompanyName})),$.fn.dataTable.ext.type.order["birth-date-pre"]=function(e){let t=e.split("/");return new Date(t[2],t[0],t[1])},db.ref("/Users").once("value",(function(e){data=e.val(),(users_id=(users_id=Object.keys(data)).slice(0,users_id.length)).forEach((e=>{switch(String(data[e].insuranceCompany.name)){case"Shinkong Insurance":user_id=String(e),data[e].user_id=user_id,ShinkongInsurance.push(data[e]);break;case"Nan Shan Insurance":user_id=String(e),data[e].user_id=user_id,NanShanInsurance.push(data[e]);break;case"Fubon Insurance ":user_id=String(e),data[e].user_id=user_id,FubonInsurance.push(data[e]);break;case"Cathay Century Insurance":user_id=String(e),data[e].user_id=user_id,CathayCenturyInsurance.push(data[e]);break;case"No insurance":user_id=String(e),data[e].user_id=user_id,NAN.push(data[e]);break}count++}));var t,a=document.querySelector("tbody.customer-table-tbody");"FubonInsurance"==getCookie("CompanyName")&&FubonInsurance.forEach((e=>{t='<tr>\n                            <td class="customer_number">'+Number(customer_count)+'</td>\n                            <td class="customer_name">'+e.realName+'</td>\n                            <td class="customer_gender">'+e.gender+'</td>\n                            <td class="customer_birth">'+e.birthDate+'</td>\n                            <td class="customer_detail"><a href="#" id="user_info_'+e.user_id+'" class="user_info">點擊查看</a></td>\n                        </tr>',a.innerHTML+=t,customer_count++})),"NanShanInsurance"==getCookie("CompanyName")&&NanShanInsurance.forEach((e=>{t='<tr>\n                            <td class="customer_number">'+Number(customer_count)+'</td>\n                            <td class="customer_name">'+e.realName+'</td>\n                            <td class="customer_gender">'+e.gender+'</td>\n                            <td class="customer_birth">'+e.birthDate+'</td>\n                            <td class="customer_detail"><a href="#" id="user_info_'+e.user_id+'" class="user_info">點擊查看</a></td>\n                        </tr>',a.innerHTML+=t,customer_count++})),"CathayCenturyInsurance"==getCookie("CompanyName")&&CathayCenturyInsurance.forEach((e=>{t='<tr>\n                            <td class="customer_number">'+Number(customer_count)+'</td>\n                            <td class="customer_name">'+e.realName+'</td>\n                            <td class="customer_gender">'+e.gender+'</td>\n                            <td class="customer_birth">'+e.birthDate+'</td>\n                            <td class="customer_detail"><a href="#" id="user_info_'+e.user_id+'" class="user_info">點擊查看</a></td>\n                        </tr>',a.innerHTML+=t,customer_count++})),"ShinkongInsurance"==getCookie("CompanyName")&&ShinkongInsurance.forEach((e=>{t='<tr>\n                            <td class="customer_number">'+Number(customer_count)+'</td>\n                            <td class="customer_name">'+e.realName+'</td>\n                            <td class="customer_gender">'+e.gender+'</td>\n                            <td class="customer_birth">'+e.birthDate+'</td>\n                            <td class="customer_detail"><a href="#" id="user_info_'+e.user_id+'" class="user_info">點擊查看</a></td>\n                        </tr>',a.innerHTML+=t,customer_count++})),"NAN"==getCookie("CompanyName")&&NAN.forEach((e=>{t='<tr>\n                            <td class="customer_number">'+Number(customer_count)+'</td>\n                            <td class="customer_name">'+e.realName+'</td>\n                            <td class="customer_gender">'+e.gender+'</td>\n                            <td class="customer_birth">'+e.birthDate+'</td>\n                            <td class="customer_detail"><a href="#" id="user_info_'+e.user_id+'" class="user_info">點擊查看</a></td>\n                        </tr>',a.innerHTML+=t,customer_count++})),Number(count-1)==Object.keys(data).length&&(document.querySelectorAll("a.user_info").forEach((e=>{e.addEventListener("click",(e=>{null!=getCookie("uid")&&delCookie("uid"),document.cookie="uid="+String(e.target.id).substring(10),window.location="insuranceCompany_UserProfile.html"}))})),$("#table-demo").DataTable({lengthMenu:[[5,10,15,20],[5,10,15,20]],language:{lengthMenu:"顯示 _MENU_ 筆資料",sProcessing:"處理中...",sZeroRecords:"查無符合結果",sInfo:"目前有 _MAX_ 筆資料",sInfoEmpty:"目前共有 0 筆紀錄",sInfoFiltered:" ",sInfoPostFix:"",sSearch:"搜尋:",sUrl:"",sEmptyTable:"尚未有資料紀錄存在",sLoadingRecords:"載入資料中...",sInfoThousands:",",oPaginate:{sFirst:"首頁",sPrevious:"上一頁",sNext:"下一頁",sLast:"末頁"},order:[[0,"desc"]],oAria:{sSortAscending:": 以升序排列此列",sSortDescending:": 以降序排列此列"}},columnDefs:[{type:"birth-date",targets:3}]}),$(".loader-wrapper").fadeOut("slow"))}));